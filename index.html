<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Scenario v8: TRAFÄ°K TSUNAMÄ°SÄ°: BÃ¼yÃ¼k Ã–lÃ§ekli DDoS Krizi</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/dracula.min.css">
    <style>
        :root {
            --dark-bg: #1a1a2e;
            --container-bg: #2a2a4a;
            --section-bg: #333355;
            --interactive-bg: #444466;
            --accent-blue: #8be9fd;
            --accent-purple: #bd93f9;
            --accent-pink: #ff79c6;
            --accent-green: #50fa7b;
            --accent-yellow: #f1fa8c;
            --accent-red: #ff5555;
            --text-light: #e0e0e0;
            --text-dark: #282a36;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        body { 
            font-family: 'Roboto', sans-serif; 
            background-color: var(--dark-bg); 
            color: var(--text-light); 
            margin: 0; 
            padding: 20px; 
            display: flex; 
            justify-content: center; 
            align-items: flex-start; 
            min-height: 100vh;
            font-size: 0.95em; 
        }

        .container { 
            background-color: var(--container-bg); 
            border-radius: 12px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); 
            padding: 20px; 
            max-width: 950px; 
            width: 100%; 
            margin: 40px 0; 
        }

        @media (min-width: 768px) { .container { padding: 40px; } }

        .centered-page { 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            text-align: center; 
            min-height: 60vh; 
            animation: fadeIn 0.5s ease-out; 
        }

        h1 { font-size: 2.4em; color: var(--accent-blue); margin-bottom: 20px; }
        h2 { font-size: 1.9em; color: var(--accent-blue); border-bottom: 2px solid var(--interactive-bg); padding-bottom: 15px; margin-bottom: 25px; text-align: left; }
        h3 { font-size: 1.5em; color: var(--accent-purple); text-align: left; margin-top: 25px; margin-bottom: 15px; }
        h4 { font-size: 1.1em; color: var(--accent-yellow); text-align: left; margin-top: 0; border-bottom: 1px solid var(--interactive-bg); padding-bottom: 10px; }
        p { line-height: 1.7; font-size: 1em; }

        .section { display: none; padding: 20px; background-color: var(--section-bg); border-radius: 8px; margin-top: 25px; animation: fadeIn 0.5s ease-out; }
        @media (min-width: 768px) { .section { padding: 30px; } }

        .interactive-element { background-color: var(--interactive-bg); border-radius: 8px; padding: 20px; margin-top: 20px; }
        .decision-buttons { display: flex; flex-direction: column; gap: 15px; margin-top: 30px; }
        .btn { background-color: #6272a4; color: white; border: none; padding: 15px 25px; border-radius: 8px; cursor: pointer; font-size: 1.1em; transition: all 0.3s ease; text-align: left; display: flex; align-items: center; gap: 15px; font-weight: 700; }
        .btn:hover { background-color: #7a8ab9; transform: translateY(-3px); box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .btn:disabled { background-color: #555 !important; color: #999 !important; cursor: not-allowed; transform: none; box-shadow: none; opacity: 0.7; }
        .btn .btn-text { flex-grow: 1; }
        .btn small { display: block; font-size: 0.85em; opacity: 0.8; margin-top: 5px; font-weight: 400; }
        .btn-start, .btn-continue { font-size: 1.3em; font-weight: bold; text-align: center; background-color: var(--accent-green); color: var(--text-dark); justify-content: center; }

        #intermissionSection .metric-change { font-size: 1.2em; margin: 15px 0; display: flex; align-items: center; gap: 10px; }
        .metric-change .positive { color: var(--accent-green); }
        .metric-change .negative { color: var(--accent-red); }
        .metric-change .neutral { color: var(--accent-blue); } 

        #statusBar { display: flex; justify-content: space-around; flex-wrap: wrap; gap: 15px; background-color: var(--text-dark); padding: 15px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #6272a4; }
        #statusBar .metric { text-align: center; font-size: 0.9em; flex: 1; min-width: 100px; } 
        #statusBar .metric .value { font-size: 1.3em; font-weight: bold; color: var(--accent-yellow); }

        .final-metrics { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-top: 20px; width: 100%; max-width: 850px; } 
        .metric-card { background-color: var(--section-bg); padding: 25px; border-radius: 8px; text-align: center; border: 1px solid var(--interactive-bg); transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.2); display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 150px; }
        .metric-card:hover { transform: scale(1.05); border-color: var(--accent-blue); }
        .metric-card .icon { font-size: 2.5em; color: var(--accent-blue); margin-bottom: 10px; }
        .metric-card .label { font-size: 1.1em; margin-bottom: 5px; color: var(--text-light); }
        .metric-card .value { font-size: 1.8em; font-weight: bold; color: var(--accent-yellow); }

        .code-block, .slack-chat { background-color: var(--text-dark); border: 1px solid #6272a4; border-radius: 8px; padding: 20px; margin-top: 15px; white-space: pre-wrap; word-break: break-all; font-family: 'Consolas', monospace; }
        .learning-note { background-color: var(--text-dark); border-left: 5px solid var(--accent-blue); padding: 20px; border-radius: 8px; margin-top: 30px; }
        .scenario-image { width: 100%; max-width: 500px; margin: 25px auto; display: block; border-radius: 8px; border: 1px solid var(--interactive-bg); box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .slack-chat .message { margin-bottom: 10px; padding: 8px; border-radius: 5px; background-color: #3f3f5a; }
        .slack-chat .sender { font-weight: bold; color: var(--accent-pink); }
        .slack-chat .sender.ciso { color: var(--accent-green); }
        .slack-chat .sender.ops { color: var(--accent-yellow); }
        .slack-chat .sender.legal { color: var(--accent-blue); }
        .slack-chat .sender.ceo { color: var(--accent-purple); }
        .slack-chat .sender.cto { color: var(--accent-green); } 
        .slack-chat .sender.pr { color: var(--accent-pink); } 
        .slack-chat .sender.finance { color: var(--accent-red); } 
        .slack-chat .sender.vendor { color: var(--accent-blue); }

        .suspect-card { background-color: var(--interactive-bg); border-radius: 8px; padding: 20px; margin-bottom: 15px; border-left: 5px solid var(--accent-purple); box-shadow: 0 2px 8px rgba(0,0,0,0.2); text-align: left;}
        .suspect-card h4 { margin-top: 0; margin-bottom: 10px; border-bottom: none; color: var(--accent-purple); }
        .suspect-card p {font-size: 0.9em; line-height: 1.6;}
        .suspect-card strong { color: var(--accent-yellow); }

        #finalSection { text-align: center; }
        #performance-badge-container { margin: 25px 0; }
        #performance-badge { padding: 12px 30px; font-size: 1.8em; font-weight: bold; border-radius: 50px; display: inline-block; color: var(--text-dark); box-shadow: 0 5px 20px rgba(0,0,0,0.4); transition: transform 0.3s ease; }
        #performance-badge:hover { transform: scale(1.05); }
        .post-crisis-layout { display: grid; grid-template-columns: 1fr; gap: 30px; text-align: left; margin-top: 40px; width: 100%; }
        @media (min-width: 800px) { .post-crisis-layout { grid-template-columns: 1fr 1fr; } }
        .event-timeline, .strategic-debrief { background-color: var(--interactive-bg); padding: 25px; border-radius: 8px; border: 1px solid var(--section-bg); margin-top: 20px; }
        .event-timeline h3, .strategic-debrief h3 { margin-top: 0; padding-bottom: 10px; border-bottom: 1px solid var(--section-bg); color: var(--accent-blue); display: flex; align-items: center; gap: 10px; }
        .event-timeline ul { list-style-type: none; padding-left: 0; margin: 15px 0 0 0; }
        .event-timeline li { position: relative; padding: 5px 0 15px 35px; border-left: 2px solid var(--section-bg); font-size: 0.95em; }
        .event-timeline li:last-child { border-left: none; }
        .event-timeline li::before { content: '\f00c'; font-family: 'Font Awesome 6 Free'; font-weight: 900; color: var(--accent-green); position: absolute; left: -12px; top: 5px; background-color: var(--dark-bg); width: 22px; height: 22px; border-radius: 50%; text-align: center; line-height: 22px; font-size: 0.8em; border: 2px solid var(--section-bg); }
        .event-timeline li.negative::before { content: '\f00d'; color: var(--accent-red); }
        .event-timeline li.neutral::before { content: '\f05a'; color: var(--accent-blue); }
        .event-timeline li .decision-title { font-weight: bold; color: var(--accent-purple); display: block; margin-bottom: 4px; }
        .event-timeline li .decision-impact { font-style: italic; opacity: 0.8; font-size: 0.9em; }
        #strategic-debrief-content p { font-size: 1em; margin-bottom: 15px; }

        .intro-info-grid { display: grid; grid-template-columns: 1fr; gap: 30px; margin-top: 30px; width: 100%; max-width: 800px; text-align: left; }
        @media (min-width: 768px) { .intro-info-grid { grid-template-columns: 1fr 1fr; } }

        .intro-roles-container, .intro-metrics-container {
            background-color: var(--section-bg);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border: 1px solid var(--interactive-bg);
        }
        .intro-roles-container h3, .intro-metrics-container h3 {
            margin-top: 0; padding-bottom: 10px; border-bottom: 1px solid var(--interactive-bg);
            color: var(--accent-purple); text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .intro-roles-container ul, .intro-metrics-container ul { list-style: none; padding: 0; margin: 0; }
        .intro-roles-container li, .intro-metrics-container li {
            display: flex; align-items: center; gap: 15px; margin-bottom: 15px; padding: 10px 0; border-bottom: 1px dashed var(--interactive-bg); font-size: 1.05em;
        }
        .intro-roles-container li:last-child, .intro-metrics-container li:last-child { border-bottom: none; margin-bottom: 0; }
        .intro-roles-container li .icon, .intro-metrics-container li .icon { font-size: 1.8em; color: var(--accent-blue); flex-shrink: 0; width: 35px; text-align: center; }
        .intro-roles-container li strong { color: var(--accent-yellow); }
        .intro-roles-container li small { display: block; font-size: 0.9em; color: var(--text-light); opacity: 0.8; margin-top: 3px; }

        /* === Liderlik tablosu (modal) â€” yenilenen tasarÄ±m === */
.lb-overlay{
    display:none; position:fixed; inset:0;
    background: rgba(10,10,25,.7);
    -webkit-backdrop-filter: blur(4px);
    backdrop-filter: blur(4px);
    z-index:9999; align-items:center; justify-content:center; padding:20px;
}
.lb-modal{
    background: linear-gradient(180deg, #2a2a4a 0%, #1f1f36 100%);
    color: var(--text-light);
    width:100%; max-width: 760px; border-radius:14px; padding:22px 22px 16px;
    border:1px solid rgba(255,255,255,.08);
    box-shadow: 0 18px 50px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.04);
}
.lb-header{
    display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px;
}
.lb-title{
    display:flex; align-items:center; gap:10px;
    font-size:1.25em; font-weight:800; letter-spacing:.2px; color: var(--accent-yellow);
}
.lb-title i{ filter: drop-shadow(0 2px 6px rgba(0,0,0,.35)); }
.lb-sub{ font-size:.92em; opacity:.85; color:#cfd3ff; }

.lb-tablewrap{
    margin-top:10px;
    max-height: 60vh; overflow:auto;
    border:1px solid var(--interactive-bg); border-radius:10px;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
}

/* Tablo */
table.lb-table{ width:100%; border-collapse:collapse; font-size:.97em; }
table.lb-table th, table.lb-table td{ padding:10px 12px; text-align:left; }
table.lb-table thead th{
    position: sticky; top:0; z-index:1;
    background:#1f1f36; color:#e9e9ff;
    border-bottom: 1px solid #3b3b66;
    font-weight:700; letter-spacing:.3px;
}
table.lb-table tbody td{ border-bottom:1px solid rgba(255,255,255,.06); color:#e9e9f5; }
table.lb-table tbody tr:hover{ background-color: rgba(255,255,255,.045); }

/* Ä°lk 3 sÄ±rayÄ± vurgula + rozet */
table.lb-table tbody tr:nth-child(1){
    background: linear-gradient(90deg, rgba(255,215,0,.18), transparent 65%);
}
table.lb-table tbody tr:nth-child(1) td:first-child::after{ content:" ğŸ¥‡"; }
table.lb-table tbody tr:nth-child(2){
    background: linear-gradient(90deg, rgba(192,192,192,.18), transparent 65%);
}
table.lb-table tbody tr:nth-child(2) td:first-child::after{ content:" ğŸ¥ˆ"; }
table.lb-table tbody tr:nth-child(3){
    background: linear-gradient(90deg, rgba(205,127,50,.18), transparent 65%);
}
table.lb-table tbody tr:nth-child(3) td:first-child::after{ content:" ğŸ¥‰"; }

/* Alt aksiyon butonlarÄ± */
.lb-actions{ display:flex; gap:12px; justify-content:flex-end; margin-top:14px; }
.lb-close, .lb-refresh{
    border:0; border-radius:10px; padding:10px 14px; cursor:pointer; font-weight:700;
    transition: transform .12s ease, box-shadow .12s ease, opacity .12s ease;
}
.lb-refresh{ background: var(--accent-blue); color:#0c1130; }
.lb-close{ background: #3d3d60; color:#fff; }
.lb-refresh:hover{ transform: translateY(-1px); box-shadow: 0 8px 18px rgba(139,233,253,.22); }
.lb-close:hover{ transform: translateY(-1px); box-shadow: 0 8px 18px rgba(0,0,0,.35); }

/* KÃ¼Ã§Ã¼k ekran iyileÅŸtirmeleri */
@media (max-width: 420px){
  .lb-title{ font-size:1.05em; }
  table.lb-table th, table.lb-table td{ padding:9px 10px; }
}

    </style>
</head>
<body>
    <div class="container">
        
        <div id="introSection" class="centered-page">
            <h1><i class="fa-solid fa-water"></i> TRAFÄ°K TSUNAMÄ°SÄ°: BÃ¼yÃ¼k Ã–lÃ§ekli DDoS Krizi</h1>
            <p style="max-width: 600px;">HoÅŸ geldiniz, **Ã‡OLHAK Teknoloji**'nin **AÄŸ GÃ¼venlik UzmanÄ±**! GÃ¶reviniz kritik: Åirketinizin ana sunucularÄ±na yÃ¶nelik, uluslararasÄ± bir botnet tarafÄ±ndan gerÃ§ekleÅŸtirilen **bÃ¼yÃ¼k Ã¶lÃ§ekli bir DDoS saldÄ±rÄ±sÄ±** altÄ±ndasÄ±nÄ±z. Web siteleri, hizmetler ve hatta iÃ§ aÄŸ baÄŸlantÄ±larÄ± kesintiye uÄŸramak Ã¼zere. Bu saldÄ±rÄ±, sistemleri aÅŸÄ±rÄ± yÃ¼kleyerek iÅŸ sÃ¼rekliliÄŸini tehdit ediyor ve itibarÄ±nÄ±za bÃ¼yÃ¼k zarar veriyor. GÃ¶reviniz: SaldÄ±rÄ±yÄ± hafifletmek, trafiÄŸi yÃ¶nlendirmek, altyapÄ±yÄ± korumak ve iÅŸ sÃ¼rekliliÄŸini saÄŸlamak iÃ§in zamana karÅŸÄ± yarÄ±ÅŸmak!</p>
            <img src="intro.png" alt="DDoS attack themed intro image" class="scenario-image">

            <div class="intro-info-grid">
                <div class="intro-roles-container">
                    <h3><i class="fa-solid fa-people-arrows"></i> SimÃ¼lasyon Rolleri</h3>
                    <ul>
                        <li class="your-role">
                            <span class="icon"><i class="fa-solid fa-network-wired"></i></span>
                            <div>
                                <strong>Sizin RolÃ¼nÃ¼z: AÄŸ GÃ¼venlik UzmanÄ±</strong> 
                                <small>Åirketin aÄŸ altyapÄ±sÄ±nÄ±n gÃ¼venliÄŸinden sorumlusun. DDoS mitigasyon adÄ±mlarÄ±nda aktif rol alÄ±yorsun. SeÃ§imlerin sonucu doÄŸrudan etkileyecek.</small>
                            </div>
                        </li>
                        <li><span class="icon"><i class="fa-solid fa-user-tie"></i></span><div><strong>CISO Melih Kaan</strong> <small>GÃ¼venlikten sorumlu, hÄ±zlÄ± ve etkili mitigasyon bekliyor.</small></div></li>
                        <li><span class="icon"><i class="fa-solid fa-microchip"></i></span><div><strong>CTO Onur GÃ¼ngor</strong> <small>AltyapÄ± performansÄ± ve iÅŸ sÃ¼rekliliÄŸi Ã¶ncelikli.</small></div></li>
                        <li><span class="icon"><i class="fa-solid fa-users-gear"></i></span><div><strong>CEO Ayfer YÄ±ldÄ±z</strong> <small>Åirket itibarÄ± ve finansal kayÄ±plarÄ± minimize etmek istiyor.</small></div></li>
                        <li><span class="icon"><i class="fa-solid fa-cloud"></i></span><div><strong>CDN/DDoS Koruma SaÄŸlayÄ±cÄ±sÄ±</strong> <small>DÄ±ÅŸarÄ±dan destek saÄŸlayacak, ancak her zaman hÄ±zlÄ± yanÄ±t veremeyebilir.</small></div></li>
                    </ul>
                </div>

                <div class="intro-metrics-container">
                    <h3><i class="fa-solid fa-chart-line"></i> Temel Metrikler</h3>
                    <ul>
                        <li><span class="icon" style="color: var(--accent-red);"><i class="fa-solid fa-gauge-high"></i></span><div><strong>Sistem YÃ¼kÃ¼</strong> <small>SunucularÄ±n DDoS trafiÄŸine karÅŸÄ± direnci. (BaÅŸlangÄ±Ã§: AÅŸÄ±rÄ± YÃ¼ksek)</small></div></li>
                        <li><span class="icon" style="color: var(--accent-green);"><i class="fa-solid fa-shield-virus"></i></span><div><strong>SaldÄ±rÄ± EtkinliÄŸi</strong> <small>DDoS saldÄ±rÄ±sÄ±nÄ±n gÃ¼cÃ¼ ve etkisi. (BaÅŸlangÄ±Ã§: Tam)</small></div></li>
                        <li><span class="icon" style="color: var(--accent-yellow);"><i class="fa-solid fa-sack-dollar"></i></span><div><strong>Finansal Zarar</strong> <small>Kesintiden kaynaklanan maliyet. (BaÅŸlangÄ±Ã§: â‚º0)</small></div></li>
                        <li><span class="icon" style="color: var(--accent-blue);"><i class="fa-solid fa-hourglass-half"></i></span><div><strong>Kesinti SÃ¼resi</strong> <small>Hizmet kesintisinin toplam sÃ¼resi. (BaÅŸlangÄ±Ã§: 0 Dakika)</small></div></li>
                        <li><span class="icon" style="color: var(--accent-pink);"><i class="fa-solid fa-heart-crack"></i></span><div><strong>MÃ¼ÅŸteri Memnuniyeti</strong> <small>MÃ¼ÅŸterilerin hizmete eriÅŸiminden memnuniyeti. (BaÅŸlangÄ±Ã§: 100)</small></div></li>
                    </ul>
                </div>
            </div>
            <button class="btn btn-start" id="startButton"><i class="fa-solid fa-play"></i> SimÃ¼lasyonu BaÅŸlat</button>
        </div>

        <div id="intermissionSection" class="centered-page" style="display: none;">
            <h2 id="intermissionTitle"></h2>
            <p id="intermissionText" style="max-width: 600px;"></p>
            <div class="interactive-element" style="width: 100%; max-width: 500px;">
                <h4>Karar Etkileri</h4>
                <div id="intermissionMetrics"></div>
            </div>
            <div class="interactive-element" style="width: 100%; max-width: 500px; border-left-color: var(--accent-blue); margin-top: 20px;">
                <h4>Stratejik DeÄŸerlendirme</h4>
                <p id="strategicText" style="font-size: 1em;"></p>
            </div>
            <button class="btn btn-continue" id="continueButton" style="margin-top: 30px;"><i class="fa-solid fa-forward"></i> Devam Et</button>
        </div>

        <div id="gameContainer" style="display: none;">
            <div id="statusBar">
                <div class="metric"><span><i class="fa-solid fa-gauge-high"></i> Sistem YÃ¼kÃ¼</span><div class="value" id="status-systemLoad">AÅŸÄ±rÄ± YÃ¼ksek</div></div>
                <div class="metric"><span><i class="fa-solid fa-shield-virus"></i> SaldÄ±rÄ± EtkinliÄŸi</span><div class="value" id="status-attackEffectiveness">Tam</div></div>
                <div class="metric"><span><i class="fa-solid fa-sack-dollar"></i> Finansal Zarar</span><div class="value" id="status-financialLoss">â‚º0</div></div>
                <div class="metric"><span><i class="fa-solid fa-hourglass-half"></i> Kesinti SÃ¼resi</span><div class="value" id="status-downtime">0 Dakika</div></div>
                <div class="metric"><span><i class="fa-solid fa-heart-crack"></i> MÃ¼ÅŸteri Memnuniyeti</span><div class="value" id="status-customerSatisfaction">100</div></div>
                <!-- EKLENDÄ°: Global SayaÃ§ -->
                <div class="metric" id="status-timer"><span><i class="fa-solid fa-stopwatch"></i> Kalan SÃ¼re</span><div class="value" id="status-remaining">04:00</div></div>
            </div>
            <div id="game-content">

                <div id="ddos_phase1_initial_detection" class="section">
                    <h2><i class="fa-solid fa-wave-square"></i> AÅŸama 1: Ä°lk Tespit ve Trafik AnormalliÄŸi</h2>
                    <h3>Saat 0:00 - Trafik UyarÄ±sÄ±!</h3>
                    <p>Gece yarÄ±sÄ±, aÄŸ izleme sistemlerinizden art arda kritik uyarÄ±lar gelmeye baÅŸladÄ±: "Anormal trafik artÄ±ÅŸÄ± tespit edildi!" KÄ±sa sÃ¼rede, normal trafiÄŸin onlarca katÄ± bÃ¼yÃ¼klÃ¼ÄŸÃ¼nde, daÄŸÄ±tÄ±k ve yoÄŸun bir istek seli ana sunucularÄ±nÄ±za yÃ¶neldiÄŸini fark ettiniz. Bu, bariz bir **bÃ¼yÃ¼k Ã¶lÃ§ekli DDoS saldÄ±rÄ±sÄ±**! Web siteniz yavaÅŸlamaya baÅŸladÄ±, hatta bazÄ± kullanÄ±cÄ±lar eriÅŸim sorunlarÄ± yaÅŸÄ±yor.</p>
                    <img src="spike.png" alt="DDoS traffic spike visual" class="scenario-image">
                    <div class="interactive-element">
                        <div class="decision-buttons">
                            <button class="btn critical" data-decision="ddos-p1-enable-onprem-mitigation" data-next-section="ddos_phase2_cdn_contact"><i class="fa-solid fa-firewall"></i><div class="btn-text">SeÃ§enek A: Mevcut On-Prem DDoS Mitigasyon Sistemlerini Aktive Et.<small>TrafiÄŸi kendi altyapÄ±ndaki Ã§Ã¶zÃ¼mlerle filtrelemeye baÅŸla. HÄ±zlÄ± ancak kapasitesi sÄ±nÄ±rlÄ± olabilir.</small></div></button>
                            <button class="btn" data-decision="ddos-p1-contact-isp" data-next-section="ddos_phase2_cdn_contact"><i class="fa-solid fa-phone-volume"></i><div class="btn-text">SeÃ§enek B: ISP ile Ä°letiÅŸime GeÃ§ ve Trafik Filtrelemesini Talep Et.<small>SaldÄ±rÄ± trafiÄŸinin ÅŸirket aÄŸÄ±na ulaÅŸmadan Ã¶nce filtrelemesini iste. DÄ±ÅŸ baÄŸÄ±mlÄ±lÄ±k ve gecikme riski var.</small></div></button>
                        </div>
                    </div>
                    <div class="learning-note"><strong>Ã–ÄŸrenme Notu:</strong> DDoS saldÄ±rÄ±larÄ±nda ilk mÃ¼dahale hÄ±zÄ± hayati Ã¶nem taÅŸÄ±r. Kendi mevcut kapasitelerini kullanmak hÄ±zlÄ± bir Ã§Ã¶zÃ¼m olabilirken, ISP desteÄŸi daha bÃ¼yÃ¼k saldÄ±rÄ±lar iÃ§in gereklidir.</div>
                </div>

                <div id="ddos_phase2_cdn_contact" class="section">
                    <h2><i class="fa-solid fa-cloud-arrow-up"></i> AÅŸama 2: CDN/DDoS Koruma SaÄŸlayÄ±cÄ±sÄ± ile Ä°letiÅŸim</h2>
                    <h3>Saat 0:45 - CDN SaÄŸlayÄ±cÄ±sÄ±ndan YanÄ±t!</h3>
                    <p>On-prem Ã§Ã¶zÃ¼mleriniz bir miktar rahatlama saÄŸlasa da, saldÄ±rÄ±nÄ±n bÃ¼yÃ¼klÃ¼ÄŸÃ¼ devam ediyor. CISO ve CTO'nun onayÄ±yla, CDN ve DDoS koruma saÄŸlayÄ±cÄ±nÄ±zla (Ã¶rneÄŸin CloudFlare, Akamai) acil bir gÃ¶rÃ¼ÅŸme baÅŸlattÄ±nÄ±z. Durumu detaylarÄ±yla aktardÄ±nÄ±z. SaÄŸlayÄ±cÄ±, trafik temizleme (scrubbing) hizmetini tam kapasite devreye alabileceklerini, ancak tam aktivasyonun ve trafiÄŸin yÃ¶nlendirilmesinin <strong>yaklaÅŸÄ±k 15-30 dakika sÃ¼rebileceÄŸini</strong> belirtti.</p>
                    <div class="interactive-element">
                    <img src="ddos.png" alt="DDoS attack themed intro image" class="scenario-image">

                        <h4>Bu bekleme sÃ¼resinde, iÅŸ sÃ¼rekliliÄŸini saÄŸlamak iÃ§in ne yapacaksÄ±n?</h4>
                        <div class="decision-buttons">
                            <button class="btn critical" data-decision="ddos-p2-temporary-service-degradation" data-next-section="ddos_phase3_traffic_diversion"><i class="fa-solid fa-minus-circle"></i><div class="btn-text">SeÃ§enek A: BazÄ± Kritik Olmayan Hizmetleri GeÃ§ici Olarak Kapat.<small>Sistem yÃ¼kÃ¼nÃ¼ azaltmak ve ana hizmetleri ayakta tutmak iÃ§in kaynak tÃ¼ketimini dÃ¼ÅŸÃ¼r.</small></div></button>
                            <button class="btn" data-decision="ddos-p2-scale-up-resources" data-next-section="ddos_phase3_traffic_diversion"><i class="fa-solid fa-arrow-up-right-dots"></i><div class="btn-text">SeÃ§enek B: Sunucu KaynaklarÄ±nÄ± HÄ±zla ArtÄ±r (Scale Up/Out).<small>Mevcut sunucularÄ±n kapasitesini artÄ±r veya ek sunucular devreye al. Maliyetli olabilir.</small></div></button>
                        </div>
                    </div>
                    <div class="learning-note"><strong>Ã–ÄŸrenme Notu:</strong> DDoS saldÄ±rÄ±larÄ±nda harici mitigasyon Ã§Ã¶zÃ¼mlerinin devreye alÄ±nma sÃ¼resi Ã¶nemlidir. Bu sÃ¼rede iÃ§ kaynaklarÄ± yÃ¶netmek, kesintiyi minimize etmek iÃ§in kritiktir.</div>
                </div>

                <div id="ddos_phase3_traffic_diversion" class="section">
                    <h2><i class="fa-solid fa-route"></i> AÅŸama 3: Trafik YÃ¶nlendirme ve Hasar KontrolÃ¼</h2>
                    <h3>Saat 1:30 - Trafik Temizleme BaÅŸladÄ±!</h3>
                    <p>CDN saÄŸlayÄ±cÄ±nÄ±z devreye girdi ve saldÄ±rÄ± trafiÄŸini temizlemeye baÅŸladÄ±. Ä°lk sinyaller olumlu, sistem yÃ¼kÃ¼ yavaÅŸ yavaÅŸ dÃ¼ÅŸÃ¼yor. Ancak saldÄ±rganlar taktik deÄŸiÅŸtirmiÅŸ gibi gÃ¶rÃ¼nÃ¼yor; Layer 7 (uygulama katmanÄ±) saldÄ±rÄ±larÄ±na odaklanarak, belirli API uÃ§ noktalarÄ±nÄ± ve oturum yÃ¶netimini hedefliyorlar. Bu, daha akÄ±llÄ±, bant geniÅŸliÄŸi yerine kaynak tÃ¼kenmesine odaklanan bir saldÄ±rÄ± tÃ¼rÃ¼.</p>
                    <p>CTO Onur GÃ¼ngor arÄ±yor: <em>"SaldÄ±rÄ± gÃ¼cÃ¼ azaldÄ± ama halen eriÅŸim sorunlarÄ± var! API'lar yavaÅŸlamÄ±ÅŸ. MÃ¼ÅŸterilerimizden ÅŸikayetler gelmeye devam ediyor. Ne yapÄ±yoruz bu Layer 7 saldÄ±rÄ±sÄ±na karÅŸÄ±?"</em></p>
                    <img src="traffic.png" alt="Traffic diversion visual" class="scenario-image">
                    <div class="interactive-element">
                        <div class="decision-buttons">
                            <button class="btn critical" data-decision="ddos-p3-rate-limiting" data-next-section="ddos_phase4_communication_and_reputation"><i class="fa-solid fa-hand-holding-dollar"></i><div class="btn-text">SeÃ§enek A: Uygulama KatmanÄ±nda Oran SÄ±nÄ±rlamasÄ± (Rate Limiting) Uygula.<small>Belirli IP adreslerinden veya kullanÄ±cÄ± oturumlarÄ±ndan gelen istek hÄ±zÄ±nÄ± kÄ±sÄ±tla. MeÅŸru kullanÄ±cÄ±larÄ± etkileyebilir.</small></div></button>
                            <button class="btn" data-decision="ddos-p3-captcha-challenges" data-next-section="ddos_phase4_communication_and_reputation"><i class="fa-solid fa-robot"></i><div class="btn-text">SeÃ§enek B: ÅÃ¼pheli Trafik iÃ§in CAPTCHA ZorlamasÄ± Getir.<small>Bot trafiÄŸini ayÄ±rt etmek iÃ§in CAPTCHA gibi interaktif zorlamalar kullan. KullanÄ±cÄ± deneyimini kÃ¶tÃ¼ etkileyebilir.</small></div></button>
                        </div>
                    </div>
                    <div class="learning-note"><strong>Ã–ÄŸrenme Notu:</strong> Layer 7 DDoS saldÄ±rÄ±larÄ± daha sofistike olup, kaynak tÃ¼ketimi yoluyla hizmet kesintisi yaratÄ±r. Bu tÃ¼r saldÄ±rÄ±lara karÅŸÄ± oran sÄ±nÄ±rlamasÄ± ve CAPTCHA gibi uygulama katmanÄ± Ã¶nlemleri Ã¶nemlidir.</div>
                </div>

                <div id="ddos_phase4_communication_and_reputation" class="section">
                    <h2><i class="fa-solid fa-podcast"></i> AÅŸama 4: Ä°letiÅŸim ve Ä°tibar YÃ¶netimi</h2>
                    <h3>Saat 2:30 - Medya ve MÃ¼ÅŸteri BaskÄ±sÄ±!</h3>
                    <p>DDoS saldÄ±rÄ±sÄ±nÄ±n etkisi kamuoyuna yayÄ±ldÄ±. Sosyal medyada ÅŸikayetler Ã§Ä±ÄŸ gibi bÃ¼yÃ¼yor, bazÄ± haber siteleri Ã‡OLHAK Teknoloji'nin hizmet kesintilerini manÅŸetine taÅŸÄ±yor. Ã–zellikle bÃ¼yÃ¼k bir e-ticaret lansmanÄ±nÄ±n bu hafta yapÄ±lacak olmasÄ±, CEO Ayfer YÄ±ldÄ±z'yi Ã§ileden Ã§Ä±karÄ±yor: <em>"Bu durum lansmanÄ± tehlikeye atÄ±yor! GÃ¼venimiz sarsÄ±lÄ±yor. MÃ¼ÅŸterilere ne aÃ§Ä±klama yapacaÄŸÄ±z? Finansal kayÄ±plarÄ±mÄ±z ne olacak?"</em></p>
                    <p>PR ekibi ve hukuk danÄ±ÅŸmanlarÄ±nÄ±z, kamuoyuna yapÄ±lacak aÃ§Ä±klamanÄ±n iÃ§eriÄŸi ve zamanlamasÄ± konusunda acil bir toplantÄ± istiyor.</p>
                    <img src="media.png" alt="DDoS public pressure visual" class="scenario-image">
                    <div class="interactive-element">
                        <div class="decision-buttons">
                            <button class="btn" data-decision="ddos-p4-transparent-apology" data-next-section="ddos_phase5_post_attack_recovery"><i class="fa-solid fa-bullhorn"></i><div class="btn-text">SeÃ§enek A: SaldÄ±rÄ±yÄ± AÃ§Ä±kla, Ã–zÃ¼r Dile ve AlÄ±nan Ã–nlemleri PaylaÅŸ.<small>Åeffaf ol, DDoS saldÄ±rÄ±sÄ± altÄ±nda olduÄŸunuzu ve mitigasyon adÄ±mlarÄ±nÄ± duyur. GÃ¼veni geri kazanmaya Ã§alÄ±ÅŸ.</small></div></button>
                            <button class="btn critical" data-decision="ddos-p4-downplay-issue" data-next-section="ddos_phase5_post_attack_recovery"><i class="fa-solid fa-masks-theater"></i><div class="btn-text">SeÃ§enek B: Sorunu 'YoÄŸun BakÄ±m' veya 'Teknik AksaklÄ±k' Olarak Nitele.<small>DDoS saldÄ±rÄ±sÄ±ndan bahsetme, durumu kÃ¼Ã§Ã¼mse ve iÃ§ bir teknik sorun olarak gÃ¶ster.</small></div></button>
                            <button class="btn" data-decision="ddos-p4-offer-compensation" data-next-section="ddos_phase5_post_attack_recovery"><i class="fa-solid fa-gift"></i><div class="btn-text">SeÃ§enek C: Hizmet Kesintisi Ä°Ã§in KullanÄ±cÄ±lara Telafi Teklif Et.<small>Finansal kaybÄ± telafi etmek iÃ§in indirim veya Ã¼cretsiz hizmet gibi teÅŸvikler sun.</small></div></button>
                        </div>
                    </div>
                    <div class="learning-note"><strong>Ã–ÄŸrenme Notu:</strong> Siber gÃ¼venlik olaylarÄ±nda iletiÅŸim stratejisi, itibar ve mÃ¼ÅŸteri gÃ¼venini doÄŸrudan etkiler. ÅeffaflÄ±k genellikle en iyi yaklaÅŸÄ±mdÄ±r.</div>
                </div>

                <div id="ddos_phase5_post_attack_recovery" class="section">
                    <h2><i class="fa-solid fa-circle-check"></i> AÅŸama 5: SaldÄ±rÄ± SonrasÄ± Kurtarma ve Dersler</h2>
                    <h3>Saat 3:30 - SaldÄ±rÄ± Kontrol AltÄ±nda!</h3>
                    <p>CDN saÄŸlayÄ±cÄ±nÄ±zÄ±n tam desteÄŸi ve sizin proaktif mÃ¼dahaleleriniz sayesinde, DDoS saldÄ±rÄ±sÄ± nihayet kontrol altÄ±na alÄ±ndÄ±. Trafik normal seviyelere dÃ¶ndÃ¼ ve hizmetleriniz tamamen eriÅŸilebilir durumda. Ancak, saldÄ±rÄ±nÄ±n etkilerini deÄŸerlendirme ve gelecekteki olasÄ± saldÄ±rÄ±lara karÅŸÄ± altyapÄ±nÄ±zÄ± gÃ¼Ã§lendirme zamanÄ±. CISO, CTO ve CEO ile birlikte kriz sonrasÄ± toplantÄ± yapÄ±yorsunuz.</p>
                    <div class="interactive-element">
                        <h4>Bu bÃ¼yÃ¼k DDoS saldÄ±rÄ±sÄ±ndan Ã§Ä±karÄ±lan derslerle, gelecekteki savunmanÄ±zÄ± nasÄ±l gÃ¼Ã§lendireceksin?</h4>
                        <div class="slack-chat" id="slackChatDDoS_P5"></div>
                        <div class="decision-buttons">
                            <button class="btn critical" data-decision="ddos-p5-invest-advanced-mitigation" data-next-section="ddos_phase6_investigation"><i class="fa-solid fa-chart-line-up"></i><div class="btn-text">SeÃ§enek A: GeliÅŸmiÅŸ DDoS Mitigasyon Ã‡Ã¶zÃ¼mlerine YatÄ±rÄ±m Yap.<small>Daha sofistike DDoS koruma hizmetleri ve donanÄ±mlarÄ± edinerek altyapÄ±yÄ± daha dayanÄ±klÄ± hale getir.</small></div></button>
                            <button class="btn" data-decision="ddos-p5-conduct-drills" data-next-section="ddos_phase6_investigation"><i class="fa-solid fa-users-medical"></i><div class="btn-text">SeÃ§enek B: DÃ¼zenli DDoS SimÃ¼lasyonlarÄ± ve Tatbikatlar Yap.<small>Ekibin kriz anÄ±nda daha hÄ±zlÄ± ve koordineli hareket etmesi iÃ§in dÃ¼zenli tatbikatlar dÃ¼zenle.</small></div></button>
                            <button class="btn" data-decision="ddos-p5-review-network-architecture" data-next-section="ddos_phase6_investigation"><i class="fa-solid fa-sitemap"></i><div class="btn-text">SeÃ§enek C: AÄŸ AltyapÄ±sÄ±nÄ± DDoS DayanÄ±klÄ±lÄ±ÄŸÄ± Ä°Ã§in Yeniden Tasarla.<small>Tek bir noktadan baÅŸarÄ±sÄ±zlÄ±ÄŸÄ± Ã¶nlemek iÃ§in aÄŸ mimarisini daÄŸÄ±tÄ±k ve yedekli hale getir.</small></div></button>
                        </div>
                    </div>
                    <div class="learning-note"><strong>Ã–ÄŸrenme Notu:</strong> DDoS saldÄ±rÄ±larÄ±ndan sonra Ã§Ä±karÄ±lan dersler, gelecekteki dayanÄ±klÄ±lÄ±k iÃ§in kritiktir. Teknoloji yatÄ±rÄ±mlarÄ±, eÄŸitim ve mimari deÄŸiÅŸiklikler uzun vadeli koruma saÄŸlar.</div>
                </div>

                <div id="ddos_phase6_investigation" class="section">
                    <h2><i class="fa-solid fa-user-secret"></i> AÅŸama 6: SoruÅŸturma ve AtÄ±f</h2>
                    <h3>Saat 4:30 - SaldÄ±rganÄ±n Ä°zinde</h3>
                    <p>SaldÄ±rÄ± tamamen durduruldu ve sistemler stabil. CISO Melih Kaan, ÅŸimdi kimin ve neden saldÄ±rdÄ±ÄŸÄ±nÄ± bulmaya odaklanmanÄ±zÄ± istiyor. Adli biliÅŸim ekibi, saldÄ±rÄ± vektÃ¶rlerini, kaynak IP'lerini ve trafik modellerini analiz ederek Ã¼Ã§ olasÄ± ÅŸÃ¼pheli belirledi. </p>
                    
                    <div class="suspect-card">
                        <h4>ÅÃ¼pheli 1: Disruptor Tech (Rakip Firma)</h4>
                        <p><strong>Motivasyon:</strong> Ã‡OLHAK Teknoloji'nin bÃ¼yÃ¼k e-ticaret lansmanÄ±nÄ± sabote etmek ve pazar avantajÄ± elde etmek. <br>
                        <strong>KanÄ±t:</strong> SaldÄ±rÄ±, Ã¶zellikle yeni Ã¼rÃ¼nle ilgili API uÃ§ noktalarÄ±nÄ± hedef alan sofistike bir Layer 7 (uygulama katmanÄ±) saldÄ±rÄ±sÄ±ydÄ±. Bu, ÅŸirketinizin iÃ§ iÅŸleyiÅŸine dair bilgi sahibi olduklarÄ±nÄ± gÃ¶steriyor olabilir.</p>
                    </div>

                    <div class="suspect-card">
                        <h4>ÅÃ¼pheli 2: Digital Justice Front (Hacktivist Grup)</h4>
                        <p><strong>Motivasyon:</strong> Ã‡OLHAK Teknoloji'nin son zamanlarda duyurduÄŸu ve kamuoyunda tartÄ±ÅŸma yaratan veri politikalarÄ±nÄ± protesto etmek.<br>
                        <strong>KanÄ±t:</strong> SaldÄ±rÄ± sÄ±rasÄ±nda grupla iliÅŸkili sosyal medya hesaplarÄ±ndan ÅŸirketinizi eleÅŸtiren Ã§ok sayÄ±da paylaÅŸÄ±m yapÄ±ldÄ±. SaldÄ±rÄ±, yÃ¼ksek hacimli ancak daha az karmaÅŸÄ±k olan Layer 3/4 (aÄŸ katmanÄ±) odaklÄ±ydÄ±.</p>
                    </div>

                    <div class="suspect-card">
                        <h4>ÅÃ¼pheli 3: Crypto-Lock Ã‡etesi (Fidye Grubu)</h4>
                        <p><strong>Motivasyon:</strong> Tamamen finansal. Åirketi hizmet dÄ±ÅŸÄ± bÄ±rakarak fidye talep etmek.<br>
                        <strong>KanÄ±t:</strong> SaldÄ±rÄ±dan 24 saat Ã¶nce, spam klasÃ¶rÃ¼ne dÃ¼ÅŸmÃ¼ÅŸ ve gÃ¶zden kaÃ§mÄ±ÅŸ dÃ¼ÅŸÃ¼k profilli bir e-postada, "hizmetlerinizde yaÅŸanacak kesintileri Ã¶nlemek iÃ§in" 5 BTC Ã¶deme talep edildiÄŸi gÃ¶rÃ¼ldÃ¼. KullanÄ±lan botnet, bu grupla iliÅŸkilendirilen Ã¶nceki saldÄ±rÄ±larda da gÃ¶rÃ¼lmÃ¼ÅŸtÃ¼.</p>
                    </div>
                    
                    <div class="interactive-element">
                         <h4>Åimdi karar zamanÄ±: Toplanan kanÄ±tlar Ä±ÅŸÄ±ÄŸÄ±nda, saldÄ±rÄ±nÄ±n arkasÄ±nda kimin olduÄŸuna inanÄ±yorsun? Bu karar, yasal sÃ¼reci ve gelecekteki savunma Ã¶nceliklerini etkileyecektir.</h4>
                        <div class="decision-buttons">
                            <button class="btn" data-decision="ddos-p6-blame-competitor" data-next-section="finalSection"><i class="fa-solid fa-briefcase"></i><div class="btn-text">SeÃ§enek A: Rakip Firma (Disruptor Tech)<small>Yasal iÅŸlem baÅŸlatmak ve endÃ¼striyel casusluÄŸa karÅŸÄ± Ã¶nlemleri artÄ±rmak iÃ§in yÃ¶netime bu bilgiyi sun.</small></div></button>
                            <button class="btn" data-decision="ddos-p6-blame-hacktivists" data-next-section="finalSection"><i class="fa-solid fa-masks-theater"></i><div class="btn-text">SeÃ§enek B: Hacktivist Grup (Digital Justice Front)<small>Halkla iliÅŸkiler ekibini devreye sokarak ÅŸirketin kamuoyu imajÄ±nÄ± dÃ¼zeltmeye ve politikalarÄ± gÃ¶zden geÃ§irmeye odaklan.</small></div></button>
                            <button class="btn critical" data-decision="ddos-p6-blame-gang" data-next-section="finalSection"><i class="fa-solid fa-skull-crossbones"></i><div class="btn-text">SeÃ§enek C: Fidye Grubu (Crypto-Lock Ã‡etesi)<small>SoruÅŸturmayÄ± siber suÃ§ birimlerine devret ve gelecekteki fidye saldÄ±rÄ±larÄ±na karÅŸÄ± savunma mekanizmalarÄ±nÄ± gÃ¼Ã§lendir.</small></div></button>
                        </div>
                    </div>
                </div>
                <div id="finalSection" class="section centered-page" style="display: none;">
                    <h2><i class="fa-solid fa-chart-line"></i> DDoS Krizi SonrasÄ± DeÄŸerlendirme Raporu</h2>
                    <p>SimÃ¼lasyon tamamlandÄ±. DDoS saldÄ±rÄ±sÄ± yÃ¶netimi performansÄ±nÄ±zÄ±n detaylÄ± dÃ¶kÃ¼mÃ¼ aÅŸaÄŸÄ±dadÄ±r.</p>
                    <div id="performance-badge-container"><span id="performance-badge"></span></div>
                    <div class="final-metrics" id="finalMetricsContainer"></div>
                    <div class="post-crisis-layout">
                        <div class="event-timeline">
                            <h3><i class="fa-solid fa-timeline"></i> Karar Zaman TÃ¼neli</h3>
                            <ul id="decision-timeline-list"></ul>
                        </div>
                        <div class="strategic-debrief">
                            <h3><i class="fa-solid fa-lightbulb"></i> Stratejik DeÄŸerlendirme ve Dersler</h3>
                            <div id="strategic-debrief-content"></div>
                        </div>
                    </div>
                    <div class="decision-buttons" style="margin-top: 40px; display:flex; gap:12px; flex-wrap:wrap; justify-content:center;">
                        <button class="btn btn-start" onclick="location.reload()"><i class="fa-solid fa-arrow-rotate-right"></i> SimÃ¼lasyonu Yeniden BaÅŸlat</button>
                        <!-- EKLENDÄ°: Liderlik tablosu butonu -->
                        <button class="btn" id="openLeaderboardBtn"><i class="fa-solid fa-trophy"></i> Liderlik Tablosu</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- EKLENDÄ°: Liderlik Tablosu Modal -->
    <div class="lb-overlay" id="leaderboardOverlay" role="dialog" aria-modal="true" aria-labelledby="lbTitle">
        <div class="lb-modal">
            <h2 id="lbTitle">Liderlik Tablosu</h2>
            <table class="lb-table" id="leaderboardTable">
                <thead>
                    <tr><th>#</th><th>Ä°sim</th><th>Puan</th><th>Tarih</th></tr>
                </thead>
                <tbody id="leaderboardBody">
                    <tr><td colspan="4">YÃ¼kleniyorâ€¦</td></tr>
                </tbody>
            </table>
            <div class="lb-actions">
                <button class="lb-refresh" id="lbRefreshBtn">Yenile</button>
                <button class="lb-close" id="lbCloseBtn">Kapat</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
document.addEventListener('DOMContentLoaded', () => {
    // DDoS SimÃ¼lasyonu MantÄ±ÄŸÄ± - ZORLAÅTIRILMIÅ VERSÄ°YON + GLOBAL TIMER + LÄ°DERLÄ°K
    window.game = {
        // METRÄ°KLER
        score: { systemLoad: 'AÅŸÄ±rÄ± YÃ¼ksek', attackEffectiveness: 'Tam', financialLoss: 0, downtime: 0, customerSatisfaction: 100 },
        // DURUM
        state: {
            currentSectionId: 'start',
            decisionHistory: [],
            attribution: null,
            totalScore: null
        },
        // ELEMENT REFERANSLARI
        elements: {},
        // GLOBAL ZAMANLAYICI (4:00)
        timer: {
            total: 240,
            remaining: 240,
            intervalId: null,
            running: false
        },
        
        // KARAR ETKÄ°LERÄ° (Aynen korunup zaten zorlaÅŸtÄ±rÄ±lmÄ±ÅŸtÄ±)
        decisionInfo: {
            'ddos-p1-enable-onprem-mitigation': {
                title: "On-Prem Mitigasyonu Aktive Et",
                text: "Kendi sistemlerini devreye soktun. Bu hÄ±zlÄ± bir ilk mÃ¼dahale oldu ancak saldÄ±rÄ±nÄ±n devasa boyutu karÅŸÄ±sÄ±nda yetersiz kalarak sistemlerini daha da strese soktu ve maliyeti artÄ±rdÄ±.",
                strat: "Kendi kaynaklarÄ±nÄ± kullanmak hÄ±zlÄ±dÄ±r ama bÃ¼yÃ¼k saldÄ±rÄ±larda genellikle sadece zaman kazandÄ±rÄ±r ve tam bir Ã§Ã¶zÃ¼m sunmaz. Bu hamle, sistemleri korurken aynÄ± zamanda mali ve operasyonel yÃ¼k getirir.",
                changes: { systemLoad: 'YÃ¼ksek', attackEffectiveness: 'AzalmÄ±ÅŸ', financialLoss: 25000, downtime: 30, customerSatisfaction: -15 },
                impact: 'Neutral'
            },
            'ddos-p1-contact-isp': {
                title: "ISP ile Ä°letiÅŸime GeÃ§ ve Filtreleme Talep Et",
                text: "ISP'ye ulaÅŸmak ve onlarÄ± aksiyon almaya ikna etmek deÄŸerli dakikalara mal oldu. Bu gecikme sÄ±rasÄ±nda saldÄ±rÄ± tam gÃ¼cÃ¼yle devam etti, hizmet kesintisi derinleÅŸti ve mÃ¼ÅŸteri gÃ¼veni ciddi oranda dÃ¼ÅŸtÃ¼.",
                strat: "ISP desteÄŸi kritik olsa da, dÄ±ÅŸ bir partiye baÄŸÄ±mlÄ±lÄ±k kriz anÄ±nda bÃ¼yÃ¼k bir risktir. Geciken her dakika, finansal ve itibar kaybÄ±nÄ± katlayarak artÄ±rÄ±r.",
                changes: { systemLoad: 'AÅŸÄ±rÄ± YÃ¼ksek', attackEffectiveness: 'Tam', financialLoss: 60000, downtime: 60, customerSatisfaction: -30 },
                impact: 'Negative'
            },
            'ddos-p2-temporary-service-degradation': {
                title: "Kritik Olmayan Hizmetleri Kapat",
                text: "Ana hizmetleri korumak adÄ±na bazÄ± servisleri kapattÄ±n. Bu, sunuculara nefes aldÄ±rdÄ± ancak bu servisleri kullanan mÃ¼ÅŸteriler iÃ§in tam bir kesinti anlamÄ±na geldi ve memnuniyetsizlik yarattÄ±.",
                strat: "Hizmet Ã¶nceliklendirme (triage) akÄ±llÄ±ca bir taktiktir, ancak her zaman bir bedeli vardÄ±r. Hangi hizmetin feda edileceÄŸi kararÄ±, mÃ¼ÅŸteri segmentleri Ã¼zerindeki etki dÃ¼ÅŸÃ¼nÃ¼lerek verilmelidir.",
                changes: { systemLoad: 'Orta', financialLoss: 15000, downtime: 5, customerSatisfaction: -18 },
                impact: 'Positive'
            },
            'ddos-p2-scale-up-resources': {
                title: "Sunucu KaynaklarÄ±nÄ± ArtÄ±r",
                text: "Bulut kaynaklarÄ±nÄ± sonuna kadar aÃ§arak saldÄ±rÄ±yÄ± kaba kuvvetle karÅŸÄ±lamaya Ã§alÄ±ÅŸtÄ±n. Bu, sistemlere bir miktar dayanÄ±klÄ±lÄ±k kazandÄ±rsa da, saldÄ±rganlar iÃ§in sadece daha bÃ¼yÃ¼k bir hedef haline geldi ve maliyetleri fÄ±rlattÄ±.",
                strat: "SaldÄ±rÄ±ya para harcamak nadiren etkili bir Ã§Ã¶zÃ¼mdÃ¼r. SaldÄ±rganlar genellikle sizin finansal limitlerinizden daha fazla kaynaÄŸa sahiptir. Bu, geÃ§ici bir yara bandÄ± olabilir ama kanamayÄ± durdurmaz.",
                changes: { systemLoad: 'YÃ¼ksek', financialLoss: 70000, downtime: 15, customerSatisfaction: -20 },
                impact: 'Negative'
            },
            'ddos-p3-rate-limiting': {
                title: "Uygulama KatmanÄ±nda Oran SÄ±nÄ±rlamasÄ± Uygula",
                text: "Agresif oran sÄ±nÄ±rlamasÄ± (rate limiting) getirdin. Bu, Layer 7 bot trafiÄŸini bÃ¼yÃ¼k Ã¶lÃ§Ã¼de kesti ama aynÄ± zamanda bazÄ± meÅŸru kullanÄ±cÄ±larÄ± ve API entegrasyonlarÄ±nÄ± da yanlÄ±ÅŸlÄ±kla engelleyerek yeni ÅŸikayetlere yol aÃ§tÄ±.",
                strat: "Oran sÄ±nÄ±rlamasÄ± L7 saldÄ±rÄ±larÄ±na karÅŸÄ± en etkili silahlardan biridir, ancak ayarlarÄ± Ã§ok hassastÄ±r. Fazla agresif olmak, saldÄ±rganÄ±n iÅŸini sizin yerinize yapmak anlamÄ±na gelebilir.",
                changes: { systemLoad: 'DÃ¼ÅŸÃ¼k', attackEffectiveness: 'KÄ±smen Kontrol', financialLoss: 10000, downtime: 5, customerSatisfaction: -10 },
                impact: 'Positive'
            },
            'ddos-p3-captcha-challenges': {
                title: "ÅÃ¼pheli Trafik iÃ§in CAPTCHA ZorlamasÄ± Getir",
                text: "Her ÅŸÃ¼pheli isteÄŸe CAPTCHA gÃ¶stermek, botlarÄ± durdurdu ancak kullanÄ±cÄ± deneyimini mahvetti. MÃ¼ÅŸterileriniz, sitenize her giriÅŸte robot olmadÄ±klarÄ±nÄ± kanÄ±tlamaktan yoruldu ve bu durum memnuniyeti dibe Ã§ekti.",
                strat: "CAPTCHA, nÃ¼kleer bir seÃ§enektir. BotlarÄ± etkili bir ÅŸekilde durdurur ama meÅŸru kullanÄ±cÄ±larÄ± da cezalandÄ±rÄ±r. Sadece en Ã§aresiz anlarda ve geÃ§ici olarak kullanÄ±lmalÄ±dÄ±r.",
                changes: { systemLoad: 'Orta', attackEffectiveness: 'KÄ±smen Kontrol', financialLoss: 5000, downtime: 5, customerSatisfaction: -35 },
                impact: 'Neutral'
            },
            'ddos-p4-transparent-apology': {
                title: "SaldÄ±rÄ±yÄ± AÃ§Ä±kla, Ã–zÃ¼r Dile ve Ã–nlemleri PaylaÅŸ",
                text: "Tam ÅŸeffaflÄ±k politikasÄ± izledin. Bu, bazÄ± mÃ¼ÅŸteriler tarafÄ±ndan takdir edilse de, ÅŸirketin zayÄ±f gÃ¶rÃ¼ndÃ¼ÄŸÃ¼nÃ¼ dÃ¼ÅŸÃ¼nen ve gÃ¼veni sarsÄ±lan bÃ¼yÃ¼k bir kitle de oldu. Ä°tibarÄ± onarmak uzun ve maliyetli olacak.",
                strat: "ÅeffaflÄ±k genellikle en iyi yoldur, ancak zamanlamasÄ± ve tonu kritiktir. Krizi kontrol altÄ±na almadan yapÄ±lan aÃ§Ä±klamalar, paniÄŸi artÄ±rabilir ve ÅŸirketi zayÄ±f gÃ¶sterebilir.",
                changes: { customerSatisfaction: +5, financialLoss: 20000 },
                impact: 'Positive'
            },
            'ddos-p4-downplay-issue': {
                title: "Sorunu 'Teknik AksaklÄ±k' Olarak Nitele",
                text: "Sorunu 'teknik aksaklÄ±k' olarak geÃ§iÅŸtirdin. Ancak siber gÃ¼venlik muhabirleri gerÃ§eÄŸi ortaya Ã§Ä±kardÄ±ÄŸÄ±nda, ÅŸirketiniz hem beceriksiz hem de yalancÄ± durumuna dÃ¼ÅŸtÃ¼. Bu, telafisi Ã§ok zor bir itibar krizi yarattÄ±.",
                strat: "Asla yalan sÃ¶yleme. Kriz anÄ±nda sÃ¶ylenen bir yalan, krizin kendisinden daha bÃ¼yÃ¼k bir hasara yol aÃ§ar. GÃ¼ven bir kez kaybedildiÄŸinde geri kazanÄ±lmasÄ± neredeyse imkansÄ±zdÄ±r.",
                changes: { customerSatisfaction: -60, financialLoss: 100000 },
                impact: 'Negative'
            },
            'ddos-p4-offer-compensation': {
                title: "Hizmet Kesintisi Ä°Ã§in Telafi Teklif Et",
                text: "MÃ¼ÅŸterilerin gÃ¶nlÃ¼nÃ¼ almak iÃ§in cÃ¶mert bir telafi paketi sundun. Bu, memnuniyeti bir miktar artÄ±rsa da, ÅŸirkete devasa bir finansal yÃ¼k getirdi ve 'sorunlarÄ± parayla Ã§Ã¶zen ÅŸirket' imajÄ± yarattÄ±.",
                strat: "Telafi, iyi niyet gÃ¶stergesidir ama temel sorunu Ã§Ã¶zmez. EÄŸer altyapÄ±nÄ±z hala zayÄ±fsa, bu sadece bir sonraki kriz iÃ§in Ã¶nden Ã¶deme yapmak anlamÄ±na gelir.",
                changes: { customerSatisfaction: +15, financialLoss: 80000 },
                impact: 'Neutral'
            },
            'ddos-p5-invest-advanced-mitigation': {
                title: "GeliÅŸmiÅŸ DDoS Mitigasyon Ã‡Ã¶zÃ¼mlerine YatÄ±rÄ±m Yap",
                text: "En pahalÄ± ve en geliÅŸmiÅŸ koruma sistemlerine yatÄ±rÄ±m yapma kararÄ± aldÄ±n. Bu, gelecekte koruma saÄŸlayacak ancak bÃ¼tÃ§ede devasa bir delik aÃ§tÄ±.",
                strat: "Teknoloji tek baÅŸÄ±na yeterli deÄŸildir. En iyi araÃ§lar bile doÄŸru insanlar ve sÃ¼reÃ§ler olmadan etkisiz kalabilir. Bu yatÄ±rÄ±m, bÃ¼tÃ¼nsel bir stratejinin sadece bir parÃ§asÄ± olmalÄ±dÄ±r.",
                changes: { financialLoss: 80000, customerSatisfaction: +5 },
                impact: 'Positive'
            },
            'ddos-p5-conduct-drills': {
                title: "DÃ¼zenli DDoS SimÃ¼lasyonlarÄ± ve Tatbikatlar Yap",
                text: "Ekibin hazÄ±rlÄ±ÄŸÄ±nÄ± artÄ±rmak iÃ§in dÃ¼zenli tatbikatlar planladÄ±n. Bu, insan faktÃ¶rÃ¼nÃ¼ gÃ¼Ã§lendiren en maliyet-etkin Ã§Ã¶zÃ¼mlerden biri.",
                strat: "Kas hafÄ±zasÄ± oluÅŸturmak kritiktir. Ekipler ne kadar Ã§ok pratik yaparsa, gerÃ§ek kriz anÄ±nda o kadar sakin ve etkili olurlar.",
                changes: { financialLoss: 20000, customerSatisfaction: +10 },
                impact: 'Positive'
            },
            'ddos-p5-review-network-architecture': {
                title: "AÄŸ AltyapÄ±sÄ±nÄ± DDoS DayanÄ±klÄ±lÄ±ÄŸÄ± Ä°Ã§in Yeniden Tasarla",
                text: "AltyapÄ±yÄ± daha dayanÄ±klÄ± hale getirmek iÃ§in mimariyi yeniden tasarlama projesi baÅŸlattÄ±n. Bu, uzun vadede en kalÄ±cÄ± Ã§Ã¶zÃ¼m olsa da, uygulanmasÄ± uzun ve maliyetli olacak.",
                strat: "DayanÄ±klÄ±lÄ±k, tasarÄ±mla baÅŸlar. Kriz anÄ±nda yama yapmak yerine, en baÅŸÄ±ndan saÄŸlam bir temel oluÅŸturmak her zaman daha iyidir.",
                changes: { financialLoss: 50000, customerSatisfaction: +7 },
                impact: 'Positive'
            },
            'ddos-p6-blame-competitor': {
                title: "SaldÄ±rgan: Rakip Firma",
                text: "KanÄ±tlar zayÄ±f olmasÄ±na raÄŸmen rakip firmayÄ± suÃ§ladÄ±n. Bu, yasal bir savaÅŸÄ± tetikledi ve sektÃ¶rde itibarÄ±nÄ±za zarar verdi. GerÃ§ek fail ise hala dÄ±ÅŸarÄ±da.",
                strat: "AtÄ±f, kesin kanÄ±t gerektirir. YanlÄ±ÅŸ bir suÃ§lama, kaynaklarÄ± boÅŸa harcamakla kalmaz, aynÄ± zamanda sizi asÄ±l tehdide karÅŸÄ± kÃ¶rleÅŸtirir ve yasal sonuÃ§lar doÄŸurur.",
                changes: { financialLoss: 50000, customerSatisfaction: -20 },
                impact: 'Negative',
                attribution: 'competitor'
            },
            'ddos-p6-blame-hacktivists': {
                title: "SaldÄ±rgan: Hacktivist Grup",
                text: "SaldÄ±rÄ±yÄ± hacktivistlere atfettin. Bu, ÅŸirketin politikalarÄ±nÄ± gÃ¶zden geÃ§irmesine neden oldu ancak teknik savunma mekanizmalarÄ± ikinci plana atÄ±ldÄ±. GerÃ§ek fail olan fidye grubu, bir sonraki saldÄ±rÄ± iÃ§in hazÄ±rlanÄ±yor.",
                strat: "Motivasyonu yanlÄ±ÅŸ anlamak, yanlÄ±ÅŸ savunmayÄ± hazÄ±rlar. PR sorununa odaklanÄ±rken, teknik borcunuzu ve zafiyetlerinizi gÃ¶z ardÄ± etmiÅŸ olursunuz.",
                changes: { financialLoss: 10000, customerSatisfaction: -10 },
                impact: 'Negative',
                attribution: 'hacktivist'
            },
            'ddos-p6-blame-gang': {
                title: "SaldÄ±rgan: Fidye Grubu",
                text: "KanÄ±tlarÄ± doÄŸru bir ÅŸekilde analiz ederek saldÄ±rÄ±nÄ±n arkasÄ±nda finansal motivasyonlu bir Ã§etenin olduÄŸunu tespit ettin. Bu, kaynaklarÄ±n doÄŸru tehdit modeline odaklanmasÄ±nÄ± saÄŸladÄ± ve kolluk kuvvetleriyle iÅŸbirliÄŸi yolunu aÃ§tÄ±.",
                strat: "DoÄŸru atÄ±f, etkili bir savunmanÄ±n temelidir. DÃ¼ÅŸmanÄ±nÄ±zÄ± tanÄ±dÄ±ÄŸÄ±nÄ±zda, ona karÅŸÄ± doÄŸru silahlarÄ± ve stratejileri geliÅŸtirebilirsiniz.",
                changes: { financialLoss: 5000, customerSatisfaction: +10 },
                impact: 'Positive',
                attribution: 'gang'
            }
        },

        setup() {
            this.elements = {
                intro: document.getElementById('introSection'), 
                game: document.getElementById('gameContainer'), 
                gameContent: document.getElementById('game-content'),
                startButton: document.getElementById('startButton'), 
                intermission: document.getElementById('intermissionSection'),
                intermissionTitle: document.getElementById('intermissionTitle'), 
                intermissionText: document.getElementById('intermissionText'),
                intermissionMetrics: document.getElementById('intermissionMetrics'), 
                strategicText: document.getElementById('strategicText'),
                continueButton: document.getElementById('continueButton'),
                statusBar: { 
                    systemLoad: document.getElementById('status-systemLoad'),
                    attackEffectiveness: document.getElementById('status-attackEffectiveness'),
                    financialLoss: document.getElementById('status-financialLoss'),
                    downtime: document.getElementById('status-downtime'),
                    customerSatisfaction: document.getElementById('status-customerSatisfaction'),
                    remaining: document.getElementById('status-remaining')
                },
                leaderboard: {
                    overlay: document.getElementById('leaderboardOverlay'),
                    body: document.getElementById('leaderboardBody'),
                    table: document.getElementById('leaderboardTable'),
                    btnOpen: document.getElementById('openLeaderboardBtn'),
                    btnClose: document.getElementById('lbCloseBtn'),
                    btnRefresh: document.getElementById('lbRefreshBtn')
                }
            };
            this.loadGameHTML();
            this.attachListeners();
            this.elements.intro.style.display = 'flex';
            this.elements.game.style.display = 'none';
        },

        attachListeners() {
            this.elements.startButton.addEventListener('click', () => {
                this.elements.intro.style.display = 'none';
                this.elements.game.style.display = 'block';
                this.startGlobalTimer(); // EKLENDÄ°: Timer baÅŸlat
                this.showSection('ddos_phase1_initial_detection'); 
            });
            
            this.elements.gameContent.addEventListener('click', (e) => {
                const button = e.target.closest('.btn[data-decision]');
                if (!button || button.disabled) {
                    return; 
                }
                
                const decisionId = button.dataset.decision;
                const nextSection = button.dataset.nextSection;


                this.handleDecision(decisionId, nextSection);
            });

            this.elements.continueButton.addEventListener('click', () => {
                const nextSectionId = this.elements.continueButton.dataset.nextSection;
                this.elements.intermission.style.display = 'none';
                
                if (nextSectionId === 'finalSection') {
                    this.showFinalReport();
                } else {
                    this.elements.game.style.display = 'block';
                    this.showSection(nextSectionId);
                }
            });

            // Liderlik Modal butonlarÄ±
            this.elements.leaderboard.btnOpen?.addEventListener('click', () => this.openLeaderboard());
            this.elements.leaderboard.btnClose?.addEventListener('click', () => this.closeLeaderboard());
            this.elements.leaderboard.btnRefresh?.addEventListener('click', () => this.loadLeaderboard());
            this.elements.leaderboard.overlay.addEventListener('click', (e) => {
                if (e.target === this.elements.leaderboard.overlay) this.closeLeaderboard();
            });
        },
        
        // KARAR UYGULAMA
        handleDecision(decisionId, nextSectionId) {
            const info = this.decisionInfo[decisionId];
            if (!info) { console.error("Decision info not found:", decisionId); return; }

            this.score.systemLoad = info.changes.systemLoad || this.score.systemLoad;
            this.score.attackEffectiveness = info.changes.attackEffectiveness || this.score.attackEffectiveness;
            this.score.financialLoss += info.changes.financialLoss || 0;
            this.score.downtime += info.changes.downtime || 0;
            this.score.customerSatisfaction = Math.max(0, Math.min(100, this.score.customerSatisfaction + (info.changes.customerSatisfaction || 0)));
            if (info.attribution) {
                this.state.attribution = info.attribution;
            }

            this.state.decisionHistory.push({ id: decisionId, title: info.title, text: info.text, impactType: info.impact, sectionId: this.state.currentSectionId });
            
            this.updateState();
            this.showIntermission(info.title, info.text, info.strat, info.changes, nextSectionId);
        },

        // ARA EKRAN
        showIntermission(title, text, strat, changes, nextSectionId) {
            this.elements.intermissionTitle.textContent = title;
            this.elements.intermissionText.textContent = text;
            this.elements.strategicText.textContent = strat;
            
            let metricsHTML = '';
            const formatChange = (label, value, unit, icon) => {
                let colorClass = 'neutral';
                let displayValue = value;
                let arrowIcon = ''; 
                let sign = '';

                if (typeof value === 'number') {
                    if (value > 0) {
                        colorClass = (label === 'MÃ¼ÅŸteri Memnuniyeti') ? 'positive' : 'negative';
                        arrowIcon = 'fa-arrow-up-long';
                        sign = '+';
                    } else if (value < 0) {
                        colorClass = (label === 'MÃ¼ÅŸteri Memnuniyeti') ? 'negative' : 'positive';
                        arrowIcon = 'fa-arrow-down-long';
                    }
                    displayValue = `${sign}${value.toLocaleString('tr-TR')}`;
                } else {
                    colorClass = 'neutral';
                }

                return `<div class="metric-change ${colorClass}"><i class="fa-solid ${icon}"></i> ${label}: ${arrowIcon ? `<i class="fa-solid ${arrowIcon}"></i>` : ''} ${displayValue}${unit}</div>`;
            };

            if (changes.systemLoad !== undefined) metricsHTML += formatChange('Sistem YÃ¼kÃ¼', changes.systemLoad, '', 'fa-gauge-high');
            if (changes.attackEffectiveness !== undefined) metricsHTML += formatChange('SaldÄ±rÄ± EtkinliÄŸi', changes.attackEffectiveness, '', 'fa-shield-virus');
            if (changes.financialLoss !== undefined && changes.financialLoss !== 0) metricsHTML += formatChange('Finansal Zarar', changes.financialLoss, 'â‚º', 'fa-sack-dollar');
            if (changes.downtime !== undefined && changes.downtime !== 0) metricsHTML += formatChange('Kesinti SÃ¼resi', changes.downtime, ' Dakika', 'fa-hourglass-half');
            if (changes.customerSatisfaction !== undefined && changes.customerSatisfaction !== 0) metricsHTML += formatChange('MÃ¼ÅŸteri Memnuniyeti', changes.customerSatisfaction, '', 'fa-heart-crack');
            
            if (metricsHTML === '') metricsHTML = '<p style="text-align: center; font-size: 1em; opacity: 0.8;">Bu kararÄ±n metrikler Ã¼zerinde doÄŸrudan bir etkisi olmadÄ±.</p>';

            this.elements.intermissionMetrics.innerHTML = metricsHTML;
            this.elements.continueButton.dataset.nextSection = nextSectionId;
            this.elements.game.style.display = 'none';
            this.elements.intermission.style.display = 'flex';
        },

        // STATUS BAR GÃœNCELLE
        updateStatusBar() {
            const s = this.score;
            this.elements.statusBar.systemLoad.textContent = s.systemLoad;
            this.elements.statusBar.attackEffectiveness.textContent = s.attackEffectiveness;
            this.elements.statusBar.financialLoss.textContent = `â‚º${s.financialLoss.toLocaleString('tr-TR')}`;
            this.elements.statusBar.downtime.textContent = `${s.downtime} Dakika`;
            this.elements.statusBar.customerSatisfaction.textContent = Math.max(0, s.customerSatisfaction);
        },

        // BÃ–LÃœM GÃ–STER
        showSection(sectionId) {
            this.elements.sections.forEach(section => { section.style.display = 'none'; });
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
                this.state.currentSectionId = sectionId;
                this.updateDynamicContent(sectionId); 
            } else {
                console.error('BÃ¶lÃ¼m bulunamadÄ±:', sectionId);
                this.showFinalReport();
            }
            this.updateState();
        },
        
        // FÄ°NAL RAPOR + PUANLAMA
        showFinalReport() {
            // Timer durdur
            this.stopGlobalTimer();

            this.elements.intro.style.display = 'none';
            this.elements.intermission.style.display = 'none';
            this.elements.game.style.display = 'block'; 
            document.getElementById('statusBar').style.display = 'none';
            this.elements.sections.forEach(section => { section.style.display = 'none'; });
            
            const finalSection = document.getElementById('finalSection');
            if (!finalSection) { console.error("Final bÃ¶lÃ¼mÃ¼ HTML'de bulunamadÄ±!"); return; }
            finalSection.style.display = 'flex';
            
            const badge = document.getElementById('performance-badge');
            const metricsContainer = document.getElementById('finalMetricsContainer');
            const timelineList = document.getElementById('decision-timeline-list');
            const debriefContent = document.getElementById('strategic-debrief-content');
            
            // PUANLAMA (hafif zorlaÅŸtÄ±rÄ±ldÄ±)
            let totalScore = 100;
            const correctAttribution = this.state.attribution === 'gang';

            // 1) Finansal Zarar CezasÄ± (Her 10,000â‚º iÃ§in 2.0 puan kayÄ±p)  <-- artÄ±rÄ±ldÄ±
            totalScore -= (this.score.financialLoss / 10000) * 2.0;

            // 2) Kesinti SÃ¼resi CezasÄ± (Her 10 dakika iÃ§in 2.5 puan kayÄ±p) <-- artÄ±rÄ±ldÄ±
            totalScore -= (this.score.downtime / 10) * 2.5;

            // 3) MÃ¼ÅŸteri Memnuniyeti CezasÄ± (100'Ã¼n altÄ±ndaki her puan iÃ§in 0.6 puan kayÄ±p) <-- artÄ±rÄ±ldÄ±
            
            // 4) YanlÄ±ÅŸ AtÄ±f CezasÄ± (aynÄ± kaldÄ±)
            if (!correctAttribution) {
                totalScore -= 25;
            }


            let badgeInfo = {};
            if (totalScore >= 90 && correctAttribution) { 
                badgeInfo = { text: 'DDoS EFENDÄ°SÄ°!', color: 'var(--accent-green)' };
            } else if (totalScore >= 75) { 
                badgeInfo = { text: 'DÄ°RENÃ‡LÄ° AÄ UZMANI', color: 'var(--accent-blue)' };
            } else if (totalScore >= 50) { 
                badgeInfo = { text: 'ZORLU DDoS DENEYÄ°MÄ°', color: 'var(--accent-yellow)' };
            } else { 
                badgeInfo = { text: 'DDoS FELAKETÄ°', color: 'var(--accent-red)' };
            }

            badge.textContent = badgeInfo.text;
            badge.style.backgroundColor = badgeInfo.color;

            metricsContainer.innerHTML = `
                <div class="metric-card"><div class="icon"><i class="fa-solid fa-file-invoice-dollar"></i></div><div class="label">Nihai Puan</div><div class="value">${totalScore}/100</div></div>
                <div class="metric-card"><div class="icon"><i class="fa-solid fa-sack-dollar"></i></div><div class="label">Finansal Zarar</div><div class="value">â‚º${this.score.financialLoss.toLocaleString('tr-TR')}</div></div>
                <div class="metric-card"><div class="icon"><i class="fa-solid fa-hourglass-half"></i></div><div class="label">Kesinti SÃ¼resi</div><div class="value">${this.score.downtime} Dakika</div></div>
                <div class="metric-card"><div class="icon"><i class="fa-solid fa-heart-crack"></i></div><div class="label">MÃ¼ÅŸteri Memnuniyeti</div><div class="value">${this.score.customerSatisfaction}/100</div></div>
            `;

            timelineList.innerHTML = this.state.decisionHistory.map(decision => {
                let liClass = decision.impactType.toLowerCase();
                return `<li class="${liClass}"><span class="decision-title">${decision.title}</span></li>`;
            }).join('');

            let debriefHTML = `<p><strong>Genel Performans PuanÄ±nÄ±z: ${totalScore}/100.</strong></p>`;
            if (badgeInfo.text === 'DDoS EFENDÄ°SÄ°!') { 
                debriefHTML += `<p><strong>OlaÄŸanÃ¼stÃ¼ BaÅŸarÄ±!</strong> Neredeyse imkansÄ±zÄ± baÅŸardÄ±n. Krizi minimum hasar, maliyet ve kesintiyle yÃ¶nettin. VerdiÄŸin kararlar sadece teknik olarak deÄŸil, stratejik olarak da mÃ¼kemmeldi. Siber gÃ¼venlikte bir usta olduÄŸunu kanÄ±tladÄ±n.</p>`;
            } else if (badgeInfo.text === 'DÄ°RENÃ‡LÄ° AÄ UZMANI') { 
                debriefHTML += `<p><strong>Etkili Kriz YÃ¶netimi!</strong> Bu zorlu senaryoda ayakta kalmayÄ± baÅŸardÄ±n. BazÄ± kayÄ±plar yaÅŸansa da, soÄŸukkanlÄ±lÄ±ÄŸÄ±nÄ± koruyarak ve doÄŸru stratejik kararlar alarak ÅŸirketi bÃ¼yÃ¼k bir felaketten kurtardÄ±n. Bu, kazanÄ±lmÄ±ÅŸ bir baÅŸarÄ±dÄ±r.</p>`;
            } else if (badgeInfo.text === 'ZORLU DDoS DENEYÄ°MÄ°') { 
                debriefHTML += `<p><strong>BÃ¼yÃ¼k Dersler Ã‡Ä±karÄ±ldÄ±.</strong> Kriz atlatÄ±ldÄ± ancak aÄŸÄ±r bir bedelle. Finansal kayÄ±plar ve kesinti sÃ¼resi, gelecekteki hazÄ±rlÄ±klarÄ±n ne kadar kritik olduÄŸunu gÃ¶steriyor. Bu deneyim, zafiyetlerinizi anlamak iÃ§in acÄ± ama gerekli bir dersti.</p>`;
            } else { 
                debriefHTML += `<p><strong>DDoS FELAKETÄ°.</strong> Kriz yÃ¶netimi yetersiz kaldÄ± ve sonuÃ§larÄ± aÄŸÄ±r oldu. Finansal, operasyonel ve itibar aÃ§Ä±sÄ±ndan bÃ¼yÃ¼k bir darbe alÄ±ndÄ±. Åirketin siber gÃ¼venlik stratejisini ve acil durum mÃ¼dahale planlarÄ±nÄ± temelden yeniden inÅŸa etmesi gerekiyor.</p>`;
            }

            if (this.state.attribution) {
                if (correctAttribution) {
                    debriefHTML += `<p><strong>SoruÅŸturma Notu:</strong> SaldÄ±rganÄ± (Fidye Grubu) doÄŸru tespit ettin. Bu kritik hamle, seni daha bÃ¼yÃ¼k bir felaketten kurtardÄ± ve puanÄ±nÄ± Ã¶nemli Ã¶lÃ§Ã¼de etkiledi.</p>`;
                } else {
                    debriefHTML += `<p><strong>SoruÅŸturma Notu:</strong> SaldÄ±rganÄ± yanlÄ±ÅŸ teÅŸhis ettin. Bu bÃ¼yÃ¼k hata, kaynaklarÄ±n yanlÄ±ÅŸ yere harcanmasÄ±na neden oldu ve nihai puanÄ±nÄ± ciddi ÅŸekilde dÃ¼ÅŸÃ¼rdÃ¼. Bir siber krizde doÄŸru atÄ±f hayati Ã¶nem taÅŸÄ±r.</p>`;
                }
            }
            debriefContent.innerHTML = debriefHTML;
            

            // Skoru liderliÄŸe otomatik kaydet (isim bu sayfada sorulmaz)
            this.saveLeaderboard(totalScore);
        },
        
        updateState() { 
            this.updateStatusBar(); 
            this.updateSlackChat(this.state.currentSectionId); 
        },

        updateSlackChat(currentSection) {
            const chatViewer = document.getElementById(this.state.currentSectionId)?.querySelector('.slack-chat');
            if (!chatViewer) return; 

            let chat = '';
            if (currentSection === 'ddos_phase5_post_attack_recovery') {
                chat = `
                    <div class="message"><span class="sender ciso">CISO Melih Kaan:</span> SaldÄ±rÄ±yÄ± atlattÄ±k ama yara aldÄ±k. Bir daha bu kadar hazÄ±rlÄ±ksÄ±z yakalanamayÄ±z. BÃ¼tÃ§e ne olursa olsun, doÄŸru adÄ±mlarÄ± atmalÄ±yÄ±z.</div>
                    <div class="message"><span class="sender cto">CTO Onur GÃ¼ngor:</span> AltyapÄ± mÄ±, ekip eÄŸitimi mi? Ã–nceliÄŸimiz ne olmalÄ±? KaynaklarÄ±mÄ±z sÄ±nÄ±rsÄ±z deÄŸil.</div>
                    <div class="message"><span class="sender ceo">CEO Ayfer YÄ±ldÄ±z:</span> Finansal tablo hiÃ§ iyi gÃ¶rÃ¼nmÃ¼yor. YapÄ±lacak her yatÄ±rÄ±mÄ±n geri dÃ¶nÃ¼ÅŸÃ¼nÃ¼ gÃ¶rmek zorundayÄ±m. Bana en maliyet-etkin Ã§Ã¶zÃ¼mÃ¼ sunun.</div>
                `;
            }
            chatViewer.innerHTML = chat;
        },
        
        updateDynamicContent(sectionId) {},

        loadGameHTML() {
            this.elements.sections = document.querySelectorAll('#game-content .section');
            if (typeof hljs !== 'undefined') {
                hljs.highlightAll();
            }
        },

        /* === GLOBAL TIMER === */
        startGlobalTimer() {
            if (this.timer.running) return;
            this.timer.running = true;
            this.timer.remaining = this.timer.total;
            this.updateTimerUI();
            this.timer.intervalId = setInterval(() => {
                this.timer.remaining--;
                this.updateTimerUI();
                if (this.timer.remaining <= 0) {
                    this.stopGlobalTimer();
                    // SÃ¼re bitti: direkt final rapora geÃ§
                    this.showFinalReport();
                }
            }, 1000);
        },
        stopGlobalTimer() {
            if (this.timer.intervalId) clearInterval(this.timer.intervalId);
            this.timer.intervalId = null;
            this.timer.running = false;
        },
        updateTimerUI() {
            const m = String(Math.floor(this.timer.remaining / 60)).padStart(2,'0');
            const s = String(this.timer.remaining % 60).padStart(2,'0');
            this.elements.statusBar.remaining.textContent = `${m}:${s}`;
        },

        /* === LÄ°DERLÄ°K TABLOSU === */
        openLeaderboard() {
            this.elements.leaderboard.overlay.style.display = 'flex';
            this.loadLeaderboard();
        },
        closeLeaderboard() {
            this.elements.leaderboard.overlay.style.display = 'none';
        },
        async saveLeaderboard(finalScore) {
            const name = (localStorage.getItem('playerName') || 'Anonim').toString().slice(0, 40);
            const payload = {
                scenario: 'v8-ddos',
                name,
                score: finalScore,
                details: {
                    financialLoss: this.score.financialLoss,
                    downtime: this.score.downtime,
                    customerSatisfaction: this.score.customerSatisfaction,
                    attribution: this.state.attribution,
                    decisions: this.state.decisionHistory.map(d => d.id)
                },
                timeSpentSec: this.timer.total - this.timer.remaining,
                timestamp: new Date().toISOString()
            };

            // Backend dene
            try {
                const res = await fetch('/api/score', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!res.ok) throw new Error('HTTP ' + res.status);
            } catch(e) {
                // Fallback: localStorage
                const key = 'leaderboard-v8-ddos';
                const arr = JSON.parse(localStorage.getItem(key) || '[]');
                arr.push(payload);
                arr.sort((a,b)=> b.score - a.score);
                localStorage.setItem(key, JSON.stringify(arr.slice(0,100)));
            }
        },
        async loadLeaderboard() {
            const tbody = this.elements.leaderboard.body;
            const key = 'leaderboard-v8-ddos';
            tbody.innerHTML = `<tr><td colspan="4">YÃ¼kleniyorâ€¦</td></tr>`;
            let rows = [];
            // Ã–nce backend
            try {
                const res = await fetch('/api/leaderboard?scenario=v8-ddos', { method:'GET' });
                if (!res.ok) throw new Error('HTTP ' + res.status);
                const data = await res.json(); // beklenen: [{name, score, timestamp}, ...]
                rows = Array.isArray(data) ? data : [];
            } catch(e) {
                // Fallback: localStorage
                const arr = JSON.parse(localStorage.getItem(key) || '[]');
                rows = arr.map(x => ({ name: x.name, score: x.score, timestamp: x.timestamp }));
            }

            if (!rows.length) {
                tbody.innerHTML = `<tr><td colspan="4">KayÄ±t yok.</td></tr>`;
                return;
            }
            rows.sort((a,b)=> b.score - a.score);
            tbody.innerHTML = rows.slice(0,50).map((r,i)=>`
                <tr>
                    <td>${i+1}</td>
                    <td>${(r.name || 'Anonim').toString().slice(0,40)}</td>
                    <td>${r.score}</td>
                    <td>${r.timestamp ? new Date(r.timestamp).toLocaleString('tr-TR') : '-'}</td>
                </tr>
            `).join('');
        }
    };

    window.game.setup();
});
    </script>
</body>
</html>
